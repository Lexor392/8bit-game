function initMain() { $.browser.mobile && isTablet || $("#canvasHolder").show(), initGameCanvas(stageW, stageH), buildGameCanvas(), buildGameButton(), "function" == typeof buildScoreBoardCanvas && buildScoreBoardCanvas(), $.editor.enable ? (loadEditPage(), goPage("game")) : (goPage("main"), "function" == typeof initSocket && multiplayerSettings.enable && initSocket("8bitmog")), checkMobileOrientation(), resizeCanvas() } function resizeGameFunc() { setTimeout(function () { $(".mobileRotate").css("left", checkContentWidth($(".mobileRotate"))), $(".mobileRotate").css("top", checkContentHeight($(".mobileRotate"))), windowW = window.innerWidth, windowH = window.innerHeight, scalePercent = windowW / contentW, contentH * scalePercent > windowH && (scalePercent = windowH / contentH), scalePercent = scalePercent > 1 ? 1 : scalePercent, windowW > stageW && windowH > stageH && windowW > stageW && (scalePercent = windowW / stageW, stageH * scalePercent > windowH && (scalePercent = windowH / stageH)); var e = stageW * scalePercent, t = stageH * scalePercent; offset.left = 0, offset.top = 0, offset.left = e > windowW ? -(e - windowW) : windowW - e, t > windowH ? offset.top = -(t - windowH) : offset.top = windowH - t, offset.x = 0, offset.y = 0, offset.left < 0 && (offset.x = Math.abs(offset.left / scalePercent / 2)), offset.top < 0 && (offset.y = Math.abs(offset.top / scalePercent / 2)), $("canvas").css("width", e), $("canvas").css("height", t), $("canvas").css("left", offset.left / 2), $("canvas").css("top", offset.top / 2), "function" == typeof initSocket && multiplayerSettings.enable && ($(".resizeFont").each(function (e, t) { $(this).css("font-size", Math.round(Number($(this).attr("data-fontsize")) * scalePercent)) }), $("#roomWrapper").css("width", e), $("#roomWrapper").css("height", t), $("#roomWrapper").css("left", offset.left / 2), $("#roomWrapper").css("top", offset.top / 2), $("#notificationHolder").css("width", e), $("#notificationHolder").css("height", t), $("#notificationHolder").css("left", offset.left / 2), $("#notificationHolder").css("top", offset.top / 2)), $(window).scrollTop(0), resizeCanvas(), "function" == typeof resizeScore && resizeScore() }, 100) } var stageW = 1280, stageH = 768, contentW = 1024, contentH = 576, viewport = { isLandscape: !0 }, landscapeSize = { w: stageW, h: stageH, cW: contentW, cH: contentH }, portraitSize = { w: 768, h: 1024, cW: 576, cH: 900 }, windowW = windowH = 0, scalePercent = 0, offset = { x: 0, y: 0, left: 0, top: 0 };